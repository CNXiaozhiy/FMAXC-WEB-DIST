"use strict";(self["webpackChunkFMAXC_WEB_VUE2"]=self["webpackChunkFMAXC_WEB_VUE2"]||[]).push([[13],{8612:function(t,s,e){e.d(s,{A:function(){return c}});var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-box-wrapper"},[s("div",{ref:"card",staticClass:"card out-card",class:`bg-${t.color||"primary"}`,on:{click:function(s){return t.$emit("click")}}},[t.type&&"normal"!==t.type?t._e():s("div",{staticClass:"card card-box-normal"},[s("div",{staticClass:"card-body p-3 d-flex align-items-center"},[s("span",{class:`b-avatar badge-light-${t.color||"primary"} rounded-circle`,staticStyle:{width:"60px",height:"60px"}},[s("span",{staticClass:"b-avatar-custom"},[t._t("icon")],2)]),s("div",{staticClass:"truncate ms-3 appcard-textarea"},[s("div",{staticClass:"d-flex align-items-center flex-wrap"},[t._t("title")],2),s("div",{staticClass:"d-none d-sm-block"},[t._t("description")],2)]),s("div",{staticClass:"appcard-btnarea"},[t._t("btnarea")],2)])]),"box"===t.type?s("div",{staticClass:"card card-box text-center"},[s("div",{staticClass:"card-body"},[s("span",{staticClass:"b-avatar mb-3 rounded-circle",class:`badge-light-${t.color||"primary"}`,staticStyle:{width:"60px",height:"60px"}},[s("span",{staticClass:"b-avatar-custom"},[t._t("icon")],2)]),s("div",{staticClass:"truncate"},[t._t("title")],2)])]):t._e()])])},a=[],r={name:"Card",props:["color","top","left","right","bottom","type"],mounted(){void 0!==this.top?this.$refs.card.style.paddingTop=this.top||".25rem":void 0!==this.left?this.$refs.card.style.paddingLeft=this.left||".25rem":void 0!==this.right?this.$refs.card.style.paddingRight=this.right||".25rem":void 0!==this.bottom&&(this.$refs.card.style.paddingBottom=this.bottom||".25rem"),void 0===this.top&&void 0===this.left&&void 0===this.right&&void 0===this.bottom&&(this.$refs.card.style.paddingTop=".25rem")}},l=r,n=e(1656),o=(0,n.A)(l,i,a,!1,null,"6356a68c",null),c=o.exports},3360:function(t,s,e){e.d(s,{A:function(){return c}});var i=function(){var t=this,s=t._self._c;return s("button",{directives:[{name:"wave",rawName:"v-wave"}],staticClass:"vBtn btn w-100",class:t.vBtnClass,attrs:{disabled:t.disabled},on:{click:t.startVerify}},[s("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",width:"1.5em",height:"1.5em",viewBox:"0 0 24 24"}},[s("g",{attrs:{fill:"none",fillRule:"evenodd"}},[s("path",{attrs:{d:"M24 0v24H0V0zM12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.019-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}}),s("path",{attrs:{fill:"currentColor",d:"M11.298 2.195a2 2 0 0 1 1.232-.055l.172.055l7 2.625a2 2 0 0 1 1.291 1.708l.007.165v5.363a9 9 0 0 1-4.709 7.911l-.266.139l-3.354 1.677a1.5 1.5 0 0 1-1.198.062l-.144-.062l-3.354-1.677a9 9 0 0 1-4.97-7.75l-.005-.3V6.693a2 2 0 0 1 1.145-1.808l.153-.065zm4.135 6.434l-4.598 4.598l-1.768-1.768a1 1 0 0 0-1.414 1.415l2.404 2.404a1.1 1.1 0 0 0 1.556 0l5.234-5.235a1 1 0 1 0-1.414-1.414"}})])]),s("span",[t._v(t._s(t.title))])])},a=[],r={name:"Vaptcha",props:["passCallback"],data(){return{vaptchaObj:{},vBtnClass:"btn-warning",title:"点我进行人机验证",disabled:!1}},mounted(){vaptcha({vid:"669bb37bd3784602950e9629",mode:"invisible",scene:0,area:"auto"}).then((t=>{this.vaptchaObj=t,t.listen("pass",(()=>{const s=t.getServerToken(),e={server:s.server,token:s.token};this.passCallback(e),this.vBtnClass="btn-success",this.title="人机验证通过！",this.disabled=!0}))}))},methods:{startVerify(){if("人机验证模块异常"!==this.title){this.disabled=!0;try{this.vaptchaObj.validate(),setTimeout((()=>{this.disabled=!1}),5e3)}catch(t){this.title="人机验证模块异常",this.vBtnClass="btn-danger"}}},reset(){this.vaptchaObj.reset(),this.vBtnClass="btn-warning",this.title="点我进行人机验证",this.disabled=!1}}},l=r,n=e(1656),o=(0,n.A)(l,i,a,!1,null,"39b03ccd",null),c=o.exports},9013:function(t,s,e){e.r(s),e.d(s,{default:function(){return v}});var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"row"},[s("div",{ref:"bindemail",staticClass:"card col-md me-3"},[s("div",{staticClass:"card-body"},[t._m(0),t.bind?t._e():s("div",[s("div",{staticClass:"d-flex align-items-start mb-3"},[s("vs-input",{attrs:{primary:"",placeholder:"请输入您的邮箱"},scopedSlots:t._u([{key:"icon",fn:function(){return[s("i",{staticClass:"bx bx-envelope"})]},proxy:!0},t.testEmail(t.form.email)&&t.form.email?null:{key:"message-danger",fn:function(){return[t._v(" 格式不正确 ")]},proxy:!0}],null,!0),model:{value:t.form.email,callback:function(s){t.$set(t.form,"email",s)},expression:"form.email"}}),s("button",{staticClass:"ms-2 btn btn-primary text-nowrap p-2 fw-bold",attrs:{disabled:!t.form.verify.token||!t.testEmail(t.form.email)||!t.form.email||t.form.send},on:{click:t.sendCode}},[t._v("发送验证码"+t._s(0===t.form.wait?"":` (${t.form.wait})`))])],1),s("Vaptcha",{ref:"vaptchaVc",staticClass:"mt-3",staticStyle:{"line-height":"normal"},attrs:{passCallback:t.vpass}}),t.form.verify.token?t._e():s("div",{staticClass:"vs-input__message vs-input__message--danger"},[t._v("请先完成人机验证")]),s("div",{staticClass:"mt-3"},[s("vs-input",{attrs:{danger:"",placeholder:"请输入验证码",disabled:!t.form.verify.token||!t.form.send},scopedSlots:t._u([{key:"icon",fn:function(){return[s("i",{staticClass:"bx bx-check-shield"})]},proxy:!0},t.form.code?null:{key:"message-danger",fn:function(){return[t._v(" 必填项 ")]},proxy:!0}],null,!0),model:{value:t.form.code,callback:function(s){t.$set(t.form,"code",s)},expression:"form.code"}}),s("button",{staticClass:"mt-2 btn btn-success w-100",attrs:{disabled:!t.testEmail(t.form.email)||!t.form.email||!t.form.verify.token||!t.form.send||!t.form.code},on:{click:t.bindEmail}},[t._v("绑定邮箱")])],1)],1),t.bind?s("div",[s("div",{staticClass:"d-flex flex-column"},[s("span",{staticClass:"text-success fs-5 fw-bold pb-2"},[s("StatusIcon",{attrs:{status:"success"}}),t._v(" 您的邮箱已完成绑定")],1),s("span",{staticClass:"text-secondary fw-bold py-2"},[s("i",{staticClass:"bx bxs-envelope"}),t._v(" "+t._s(t.$store.state.userData.user.info.email)+" ")]),s("button",{directives:[{name:"wave",rawName:"v-wave"}],staticClass:"mt-3 btn btn-danger",on:{click:t.unbindEmail}},[t._v("解除绑定")])])]):t._e()])]),s("div",{staticClass:"card col-md mt-md-0 mt-3"},[s("div",{staticClass:"card-body"},[t._m(1),s("Card",{staticClass:"w-100",attrs:{color:"danger"},scopedSlots:t._u([{key:"icon",fn:function(){return[s("font-awesome-icon",{attrs:{icon:["fas","circle-exclamation"]}})]},proxy:!0},{key:"title",fn:function(){return[s("h4",{staticClass:"font-weight-bolder m-0 text-nowrap"},[t._v("暂停服务")])]},proxy:!0}])})],1)])])},a=[function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-title"},[s("h3",[t._v("绑定邮箱")]),s("hr")])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"card-title"},[s("h3",[t._v("绑定手机")]),s("hr")])}],r=e(3360),l=e(8612),n=e(1231),o=e(7363),c=e(6853),d={name:"EmailPhone",data(){return{form:{wait:0,uname:"",email:"",code:"",send:!1,verify:{server:"",token:""}},timer:null}},components:{Card:l.A,Vaptcha:r.A,StatusIcon:n.A},computed:{bind(){return!!this.$store.state.userData.user.info.email}},methods:{vpass(t){this.form.verify.server=t.server,this.form.verify.token=t.token},testEmail(t){let s=/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/;return!!s.test(t)},async sendCode(){if(!this.testEmail(this.form.email)||!this.form.email||!this.form.verify.token||this.form.send)return;const t=this.$vs.loading({target:this.$refs.bindemail,text:"发送中..."}),s=await(0,o.Re)({email:this.form.email,verify:{sr:this.form.verify.server,tk:this.form.verify.token}});1===s.status?(this.$swal({icon:"success",title:"发送成功",text:"验证码已发送至您的邮箱，请重新完成人机验证"}),this.resetVerify(),this.form.send=!0,this.openTimer()):(this.$swal({icon:"error",title:"发送失败",text:s.msg}),this.resetVerify()),t.close()},async bindEmail(){if(!this.testEmail(this.form.email)||!this.form.email||!this.form.verify.token||!this.form.send||!this.form.code)return;const t=this.$vs.loading({target:this.$refs.bindemail,text:"绑定中..."}),s=await(0,o.Re)({email:this.form.email,verify:{sr:this.form.verify.server,tk:this.form.verify.token},code:this.form.code});1===s.status?(this.$swal({icon:"success",title:"绑定成功",text:"您的邮箱已绑定"}),await(0,c.A)(!0)):(this.$swal({icon:"error",title:"绑定失败",text:s.msg}),this.resetVerify()),t.close()},async unbindEmail(){await this.$swal({icon:"warning",title:"解除绑定",text:"您确定要解除绑定吗？",showCancelButton:!0,confirmButtonText:"确认",cancelButtonText:"取消"}).then((async t=>{if(t.isConfirmed){const t=this.$vs.loading({target:this.$refs.bindemail,text:"解绑中..."}),s=await(0,o.mD)();1===s.status?(await(0,c.A)(!0),this.$swal({icon:"success",title:"解除成功",text:"您的邮箱已解除绑定"})):(this.$swal({icon:"error",title:"解除失败",text:s.msg}),this.resetVerify()),t.close()}}))},openTimer(){this.form.wait=60,this.timer=setInterval((()=>{this.form.wait--,this.form.wait<=0&&(this.form.wait=0,this.form.send=!1,clearInterval(this.timer))}),1e3)},resetVerify(){this.$refs.vaptchaVc.reset(),this.form.verify.server="",this.form.verify.token=""}}},m=d,f=e(1656),h=(0,f.A)(m,i,a,!1,null,null,null),v=h.exports}}]);
//# sourceMappingURL=13.e07d925d.js.map